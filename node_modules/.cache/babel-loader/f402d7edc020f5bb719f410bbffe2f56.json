{"ast":null,"code":"export default {\n  name: \"get-request-async-await\",\n\n  data() {\n    return {\n      latitude: '',\n      longitude: '',\n      airportDistanceKm: 0,\n      airportDistanceMi: 0,\n      postCode: '',\n      responseStatus: 0,\n      elementVisible: true,\n      nhs_ha: '',\n      ccg: '',\n      postCodeCards: []\n    };\n  },\n\n  methods: {\n    async created() {\n      // Checks if the error alert is visible\n      if (!this.elementVisible) {\n        this.elementVisible = true;\n      }\n\n      setTimeout(() => this.elementVisible = false, 4000); // Adds a 4 second timer for error alert\n      // If the user doesn't input any postcode, we won't fetch data\n\n      if (!this.code) {\n        return;\n      } // GET request using fetch with async/await\n\n\n      const response = await fetch(`http://api.postcodes.io/postcodes/${this.code}`);\n      this.responseStatus = response.status;\n\n      if (response.status === 404) {\n        return;\n      }\n\n      const data = await response.json(); // We get the data from the API \n\n      const longitude = data.result.longitude;\n      const nhs_ha = data.result.nhs_ha;\n      const ccg = data.result.ccg;\n      const latitude = data.result.latitude;\n      this.postCode = this.code;\n      this.nhs_ha = nhs_ha, this.ccg = ccg, this.latitude = latitude;\n      this.longitude = longitude; // We attribute the distances both in miles and kilometers\n\n      let factor = 0.621371;\n      this.airportDistanceMi = (airportDistance(51.4700223, -0.4542955, latitude, longitude) * factor).toFixed(2);\n      this.airportDistanceKm = airportDistance(51.4700223, -0.4542955, latitude, longitude).toFixed(2); // Create an object array where we'll use to populate the search history cards \n\n      let searchCards = {\n        postCode: this.postCode,\n        nhs_ha: this.nhs_ha,\n        ccg: this.ccg,\n        long: this.longitude,\n        lat: this.latitude,\n        airportDistanceMi: this.airportDistanceMi,\n        airportDistanceKm: this.airportDistanceKm\n      };\n      this.postCodeCards.push(searchCards); // We then push the data into the array\n      //This function takes in latitude and longitude of two location and returns the distance between them (in km and mi)\n\n      function airportDistance(lat1, lon1, lat2, lon2) {\n        let R = 6371; // Radius of the earth in km\n\n        let dLat = toRad(lat2 - lat1);\n        let dLon = toRad(lon2 - lon1);\n        let airportLat1 = toRad(lat1);\n        let postCodeLat2 = toRad(lat2);\n        let a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(airportLat1) * Math.cos(postCodeLat2);\n        let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n        let d = R * c;\n        return d;\n      } // Converts numeric degrees to radians\n\n\n      function toRad(Value) {\n        return Value * Math.PI / 180;\n      }\n    },\n\n    async navigateGoogleMaps(lat, long) {\n      window.open(`https://maps.google.com/?q=${lat},${long}`, '_blank');\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","latitude","longitude","airportDistanceKm","airportDistanceMi","postCode","responseStatus","elementVisible","nhs_ha","ccg","postCodeCards","methods","created","setTimeout","code","response","fetch","status","json","result","factor","airportDistance","toFixed","searchCards","long","lat","push","lat1","lon1","lat2","lon2","R","dLat","toRad","dLon","airportLat1","postCodeLat2","a","Math","sin","cos","c","atan2","sqrt","d","Value","PI","navigateGoogleMaps","window","open"],"sourceRoot":"","sources":["/Users/tiagonunes/Documents/dev/pt-tiago-nunes-01/address-uk/src/components/GetPostCode.vue"],"sourcesContent":["<template>\n\n    <div class=\"flex flex-col min-h-screen\">\n\n        <div class=\"card text-center m-3\">\n            <img class=\"mx-auto  mb-6\" src=\"../assets/map-pin.svg\" alt=\"github\">\n\n            <div class=\"flex justify-center\">\n                <div class=\"mb-3 xl:w-96\">\n                    <div class=\"form-group input-group relative flex flex-wrap items-stretch w-full mb-4\">\n                        <div class=\"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none\">\n                            <svg class=\"w-5 h-5 text-gray-500 dark:text-gray-400\" fill=\"none\" stroke=\"currentColor\"\n                                viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                                    d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"></path>\n                            </svg>\n                        </div>\n                        <input @keyup.enter =\"created\" type=\"search\" v-model=\"code\"\n                            class=\"block p-4 pl-10 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\"\n                            placeholder=\"Search\" aria-label=\"Search\" aria-describedby=\"button-addon2\">\n                        <button  @click=\"created\"\n                            class=\"text-white absolute right-2.5 bottom-2.5 bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\"\n                            type=\"button\" id=\"button-addon2\">Search\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <h1 v-show=\"elementVisible\" v-if=\"responseStatus === 404\" class=\"flex justify-center mb-5\">\n                <div class=\"bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4\" role=\"alert\">\n                    <p class=\"font-bold\">Error!</p>\n                    <p>No data was found for postcode: <strong>{{ code }}</strong></p>\n                </div>\n            </h1>\n\n            <div v-if=\"postCode\">\n                <ul>\n                    <li class=\"card-body\"><strong>{{ nhs_ha }}</strong></li>\n                    <li class=\"card-body\"><strong>{{ postCode }}</strong></li>\n                    <li class=\"card-body\"><strong>{{ ccg }}</strong></li>\n                    <li class=\"card-body\">Latitude: <strong>{{ latitude }}</strong></li>\n                    <li class=\"card-body\">Longitude: <strong>{{ longitude }}</strong></li>\n                    <li class=\"card-body mb-10\">London Heathrow airport distance/Km: <strong>{{ airportDistanceKm\n                    }}</strong></li>\n                    <li class=\"card-body\">London Heathrow airport distance/Mi: <strong>{{ airportDistanceMi\n                    }}</strong></li>\n                </ul>\n            </div>\n\n\n            <div v-if=\"postCodeCards.length > 0\">\n                <h2 class=\"font-bold mb-7\">Search History</h2>\n                <div class=\"grid grid-cols-3 gap-2 text-left flex justify-center items-center ml-10\">\n                    <div v-for=\"card in postCodeCards\" :key=\"card.id\"\n                        class=\"mt-auto max-w-sm bg-white rounded-lg border border-gray-200 shadow-md dark:bg-gray-800 dark:border-gray-700 mb-6\">\n                        <a href=\"#\">\n                            <!-- <img class=\"rounded-t-lg\"\n                                src=\"https://i.pinimg.com/originals/83/26/96/832696c3ff680f405ddc47fead99fc5c.jpg\"\n                                alt=\"\" /> -->\n                        </a>\n                        <div class=\"p-5\">\n                            <div class=\"card-body\"><strong>{{ card.nhs_ha }}</strong></div>\n                            <div class=\"card-body\"><strong>{{ card.postCode }}</strong></div>\n                            <div class=\"card-body\"><strong>{{ card.ccg }}</strong></div>\n                            <div class=\"card-body\">Latitude: <strong>{{ card.lat }}</strong></div>\n                            <div class=\"card-body\">Longitude: <strong>{{ card.long }}</strong></div>\n                            <div class=\"mb-7 card-body\">London Heathrow airport distance/Km: <strong>{{\n                                    card.airportDistanceKm\n                            }}</strong>\n                            </div>\n                            <div class=\"card-body\">London Heathrow airport distance/Mi: <strong>{{\n                                    card.airportDistanceMi\n                            }}</strong>\n                            </div>\n                            \n                            <button @click=\"navigateGoogleMaps(card.lat,card.long)\" class=\"mt-auto bg-blue-700 hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-lg\">\n                                Navigate\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n        <footer class=\"mt-auto\">\n\n            <ul class=\"  text-sm text-gray-500 dark:text-gray-400\">\n                <li>\n                    <a href=\"https://github.com/tiagonunes1\" class=\"mr-4 hover:underline md:mr-6 \"><img class=\"mx-auto\"\n                            src=\"../assets/github.svg\" alt=\"github\"></a>\n                </li>\n            </ul>\n        </footer>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"get-request-async-await\",\n    data() {\n        return {\n            latitude: '',\n            longitude: '',\n            airportDistanceKm: 0,\n            airportDistanceMi: 0,\n            postCode: '',\n            responseStatus: 0,\n            elementVisible: true,\n            nhs_ha: '',\n            ccg: '',\n            postCodeCards: []\n\n        };\n    },\n    methods: {\n\n        async created() {\n            // Checks if the error alert is visible\n            if (!this.elementVisible) {\n                this.elementVisible = true;\n            }\n            setTimeout(() => this.elementVisible = false, 4000) // Adds a 4 second timer for error alert\n\n            // If the user doesn't input any postcode, we won't fetch data\n            if (!this.code) {\n                return;\n            }\n\n            // GET request using fetch with async/await\n            const response = await fetch(`http://api.postcodes.io/postcodes/${this.code}`);\n            this.responseStatus = response.status;\n            if (response.status === 404) {\n                return;\n            }\n\n            const data = await response.json(); // We get the data from the API \n\n            const longitude = data.result.longitude\n            const nhs_ha = data.result.nhs_ha\n            const ccg = data.result.ccg\n            const latitude = data.result.latitude\n            this.postCode = this.code\n            this.nhs_ha = nhs_ha,\n                this.ccg = ccg,\n                this.latitude = latitude;\n            this.longitude = longitude;\n\n            // We attribute the distances both in miles and kilometers\n            let factor = 0.621371\n            this.airportDistanceMi = (airportDistance(51.4700223, -0.4542955, latitude, longitude) * factor).toFixed(2)\n            this.airportDistanceKm = airportDistance(51.4700223, -0.4542955, latitude, longitude).toFixed(2)\n\n            // Create an object array where we'll use to populate the search history cards \n            let searchCards = { postCode: this.postCode, nhs_ha: this.nhs_ha, ccg: this.ccg, long: this.longitude, lat: this.latitude, airportDistanceMi: this.airportDistanceMi, airportDistanceKm: this.airportDistanceKm };\n            this.postCodeCards.push(searchCards); // We then push the data into the array\n\n            //This function takes in latitude and longitude of two location and returns the distance between them (in km and mi)\n            function airportDistance(lat1, lon1, lat2, lon2) {\n                let R = 6371; // Radius of the earth in km\n                let dLat = toRad(lat2 - lat1);\n                let dLon = toRad(lon2 - lon1);\n                let airportLat1 = toRad(lat1);\n                let postCodeLat2 = toRad(lat2);\n\n                let a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n                    Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(airportLat1) * Math.cos(postCodeLat2);\n                let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n                let d = R * c;\n                return d;\n            }\n            // Converts numeric degrees to radians\n            function toRad(Value) {\n                return Value * Math.PI / 180;\n            }\n        },\n\n        async navigateGoogleMaps(lat,long) {\n            window.open(`https://maps.google.com/?q=${lat},${long}`,'_blank')\n        }\n    },\n\n};\n</script>"]},"metadata":{},"sourceType":"module"}